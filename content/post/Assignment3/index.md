---
date: 2020-04-15
title:  Assignment 3
---
{{% staticref "files/Wang_03.ipynb" "newtab" %}}Download the notebook{{% /staticref %}}
# Predicting the sentiment by Naive Bayes Classifier (http://ai.stanford.edu/~amaas/data/sentiment/)

### full name: Haibo Wang
### ID: 1001778514

```python
# full name: Haibo Wang
# ID: 1001778514
import os
import operator
```

### Build a vocabulary as list and calculate prob with laplace smoothing.
```python
# Build a vocabulary as list.
def GetVocabulary(data): 
    vocab_set = set([])
    for document in data:
        words = document.split()
        for word in words:
            vocab_set.add(word) 
    return list(vocab_set)

# Calculate
def getWords(df):
    neg = {}
    pos = {}
    total = set()
    neg_word_num = 0
    pos_word_num = 0
    neg_num = 0
    pos_num = 0
    for index, data in df.iterrows():
        label = data['Label']
        data = data['Reviews']
        data = data.split()
        if label == 1:
            neg_word_num += len(data)
            neg_num += 1
            for word in data:
                neg[word] = neg.get(word, 0) + 1
                total.add(word)
        else:
            pos_word_num += len(data)
            pos_num += 1
            for word in data:
                pos[word] = pos.get(word,0) + 1
                total.add(word)
    
    total_num = len(total)
    # Smoothing
    neg_word_num = neg_word_num + total_num 
    pos_word_num = pos_word_num + total_num
   
    return neg, pos, neg_num, pos_num, neg_word_num, pos_word_num

def Predict(neg, pos, neg_num, total_num, neg_word_num, pos_word_num, data):
    words = data.split()
    neg_pro = 0
    pos_pro = 0
    for word in words:
        neg_pro += neg.get(word, 1)
        pos_pro += pos.get(word,1)
    
    neg_pro = (neg_pro / neg_word_num) * (neg_num / (neg_num + pos_num))
    pos_pro = (pos_pro / pos_word_num) * (pos_num / (neg_num + pos_num))  
    
    if neg_pro > pos_pro:
        return 1
    else:
        return 0
```

### Import dataset
```python
#import the negetive files
import pandas as pd
import numpy as np

#train dataset
train_neg=os.listdir('/Users/faith/Downloads/ML/aclImdb/train/neg')#list all the filenames present in the directory
os.chdir('/Users/faith/Downloads/ML/aclImdb/train/neg')#set the directory path
train_set=[]
for i in train_neg:
    fp=open(i,"r",encoding="utf8")
    train_set.append(fp.read())
    fp.close()
    
#import the positive files
train_pos=os.listdir('/Users/faith/Downloads/ML/aclImdb/train/pos')
os.chdir('/Users/faith/Downloads/ML/aclImdb/train/pos')
for i in train_pos:
    fp = open(i,"r",encoding = "utf8")
    train_set.append(fp.read())
    fp.close()

train_set=pd.DataFrame(train_set,columns = ["Reviews"])
train_set["Label"] = np.zeros([len(train_set),1],dtype = int)
train_set.loc[12500:25000,"Label"] = 1
y = train_set.loc[:,"Label"]

#text dataset
test_neg=os.listdir('/Users/faith/Downloads/ML/aclImdb/test/neg')
test_pos=os.listdir('/Users/faith/Downloads/ML/aclImdb/test/pos')

#import the negetive files
os.chdir('/Users/faith/Downloads/ML/aclImdb/test/neg')
test_set=[]
for i in test_neg:
    fp=open(i,"r",encoding="utf8")
    test_set.append(fp.read())
    fp.close()
test_set[0]

#import the positive files
os.chdir('/Users/faith/Downloads/ML/aclImdb/test/pos')
for i in test_pos:
    fp=open(i,"r",encoding="utf8")
    test_set.append(fp.read())
    fp.close()

test_set=pd.DataFrame(test_set,columns=["Reviews"])
test_set["Label"]=np.zeros([len(test_set),1],dtype=int)
test_set.loc[12500:25000,"Label"]=1
y_test=test_set.loc[ : ,"Label"]
```


```python
train_set[0:5]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Reviews</th>
      <th>Label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Working with one of the best Shakespeare sourc...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Well...tremors I, the original started off in ...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Ouch! This one was a bit painful to sit throug...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>I've seen some crappy movies in my life, but t...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>"Carriers" follows the exploits of two guys an...</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
test_set[0:5]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Reviews</th>
      <th>Label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Alan Rickman &amp; Emma Thompson give good perform...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>I have seen this movie and I did not care for ...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>In Los Angeles, the alcoholic and lazy Hank Ch...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>This film is bundled along with "Gli fumavano ...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>I only comment on really very good films and o...</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
# Word frequency 
dict_fre = {} 
for index, row in train_set.iterrows():  
    label = row['Label']
    data = row['Reviews']
    data = data.lower().split()
    for word in data:
        if word not in dict_fre:
            dict_fre[word] = 1
        else:
            dict_fre[word] = dict_fre[word] + 1
vocab_fre = sorted(dict_fre.items(),key=operator.itemgetter(1),reverse=True)

```

### Statistics word frequency
```python
dict_fre
```




    {'working': 705,
     'with': 42729,
     'one': 22480,
     'of': 144462,
     'the': 322198,
     'best': 5426,
     'shakespeare': 146,
     'sources,': 10,
     'this': 69714,
     'film': 27777,
     'manages': 579,
     'to': 133967,
     'be': 25691,
     'creditable': 9,
     "it's": 15970,
     'source,': 9,
     'whilst': 263,
     'still': 5053,
     'appealing': 166,
     'a': 159953,
     'wider': 52,
     'audience.<br': 69,
     '/><br': 50935,
     '/>branagh': 6,
     'steals': 208,
     'from': 19934,
     'under': 1208,
     "fishburne's": 14,
     'nose,': 15,
     'and': 158572,
     "there's": 2814,
     'talented': 503,
     'cast': 2883,
     'on': 31619,
     'good': 11926,
     'form.': 83,
     'well...tremors': 1,
     'i,': 90,
     'original': 2672,
     'started': 865,
     'off': 4519,
     'in': 90527,
     '1990': 40,
     'i': 70480,
     'found': 2494,
     'movie': 30887,
     'quite': 3662,
     'enjoyable': 603,
     'watch.': 579,
     'however,': 2346,
     'they': 20624,
     'proceeded': 22,
     'make': 7590,
     'tremors': 23,
     'ii': 166,
     'iii.': 10,
     'trust': 268,
     'me,': 1060,
     'those': 4545,
     'movies': 5255,
     'going': 3828,
     'downhill': 66,
     'right': 2366,
     'after': 7118,
     'finished': 241,
     'first': 7985,
     'one,': 819,
     'mean,': 373,
     'ass': 129,
     'blasters???': 1,
     'now,': 567,
     'only': 11566,
     'god': 641,
     'himself': 1527,
     'is': 104171,
     'capable': 218,
     'answering': 31,
     'question': 481,
     '"why': 67,
     'gods': 36,
     'name': 1186,
     'would': 12027,
     'create': 585,
     'another': 3686,
     'these': 5233,
     'dumpster': 6,
     'dives': 19,
     'movie?"': 7,
     'iv': 36,
     'cannot': 1089,
     'considered': 458,
     'bad': 6816,
     'movie,': 3979,
     'fact': 2555,
     'it': 65505,
     'even': 12010,
     'an': 21240,
     'epitome': 42,
     'for': 42843,
     'lives': 1001,
     'up': 10776,
     'more': 13170,
     'than': 9807,
     'that.': 861,
     'as': 45102,
     'attempted': 128,
     'sit': 674,
     'though': 3141,
     'it,': 3006,
     'noticed': 236,
     'that': 66292,
     'my': 11766,
     'eyes': 798,
     'bleed,': 5,
     'hoped': 126,
     'profusely': 3,
     'little': 6122,
     'girl': 1954,
     'ring': 212,
     'crawl': 24,
     'through': 4455,
     'tv': 2058,
     'kill': 1059,
     'me.': 1125,
     'did': 5514,
     'really': 11065,
     'think': 6773,
     'dressing': 61,
     'people': 7676,
     'who': 19407,
     'had': 11042,
     'stared': 13,
     'other': 8229,
     "we're": 487,
     'wild': 344,
     'west': 290,
     '(with': 305,
     'exact': 179,
     'same': 3770,
     'occurrences)': 1,
     'any': 7507,
     'better?': 9,
     'honestly,': 103,
     'never': 6319,
     'suggest': 360,
     'buying': 169,
     'there': 13094,
     'are': 28743,
     'cheaper': 24,
     'ways': 490,
     'find': 4013,
     'things': 3123,
     'burn': 102,
     'well.': 1062,
     'ouch!': 4,
     'was': 47024,
     'bit': 2760,
     'painful': 325,
     'through.': 234,
     'has': 16570,
     'cute': 390,
     'amusing': 359,
     'premise,': 79,
     'but': 39764,
     'all': 19740,
     'goes': 2274,
     'hell': 658,
     'there.': 573,
     'matthew': 86,
     'modine': 17,
     'almost': 3019,
     'always': 2997,
     'pedestrian': 37,
     'annoying,': 102,
     'he': 26177,
     'does': 5495,
     'not': 28597,
     'disappoint': 53,
     'one.': 1171,
     'deborah': 30,
     'kara': 9,
     'unger': 12,
     'john': 1887,
     'neville': 15,
     'turned': 876,
     'surprisingly': 379,
     'decent': 998,
     'performances.': 222,
     'alan': 292,
     'bates': 35,
     'jennifer': 200,
     'tilly,': 2,
     'among': 748,
     'others,': 168,
     'played': 2238,
     'way': 5815,
     'over': 5027,
     'top.': 83,
     'know': 5336,
     "that's": 3193,
     'parts': 906,
     'were': 10528,
     'written,': 139,
     'hard': 2208,
     'blame': 264,
     'actors,': 477,
     'when': 13609,
     'script': 2128,
     'director': 3021,
     'have': 27344,
     'them': 5442,
     'do': 7904,
     'such': 4812,
     'schlock.': 15,
     'if': 15189,
     "you're": 1858,
     'outrageous': 93,
     'characters,': 820,
     'ok,': 317,
     'you': 27564,
     'gotta': 120,
     'material': 475,
     'work.': 585,
     "didn't": 4147,
     'here.': 838,
     'run': 940,
     'away': 2011,
     'screaming': 211,
     'at': 22731,
     'possible.': 171,
     "i've": 3157,
     'seen': 5333,
     'some': 15280,
     'crappy': 223,
     'life,': 715,
     'must': 2970,
     'very': 13633,
     'worst.': 98,
     'definately': 22,
     'bottom': 311,
     '100': 246,
     '(imo,': 1,
     'is).<br': 5,
     '/>we': 176,
     'follow': 564,
     'two': 6210,
     'couples,': 13,
     'dodds': 1,
     '(billy': 11,
     'bob': 214,
     'thornton': 13,
     'lonnie': 6,
     'earl': 67,
     'natasha': 26,
     'richardson': 43,
     'darlene)': 1,
     'kirkendalls': 1,
     '(patrick': 14,
     'swayze': 23,
     'roy': 166,
     'charlize': 11,
     'theron': 12,
     'candy)': 3,
     'car': 901,
     'roadtrip': 1,
     'reno.<br': 1,
     '/>apparently,': 6,
     "isn't": 3000,
     'too': 6142,
     'happy': 710,
     'his': 29059,
     'sex-life,': 1,
     'so': 18099,
     'cheats': 22,
     'wife': 1431,
     'candy,': 29,
     "who's": 657,
     'despirately': 1,
     'trying': 2406,
     'baby.': 49,
     'roy,': 6,
     'meanwhile,': 129,
     'sure': 2112,
     'sperm': 10,
     'ok': 385,
     "he's": 2790,
     'getting': 1582,
     'checked': 66,
     'by': 21976,
     'doctor.<br': 6,
     '/>now,': 88,
     'read': 1774,
     'back': 4086,
     'dvd,': 188,
     'girlfriend': 359,
     "didn't,": 22,
     'she': 12234,
     'blurted': 3,
     'out': 14510,
     'about': 16486,
     '20': 529,
     'minutes:': 4,
     "'oh": 14,
     'yeah,': 235,
     "she's": 1378,
     'gonna': 239,
     'end': 3547,
     'pregnant': 127,
     'her': 16540,
     'husband': 644,
     "can't": 3442,
     "baby's'.": 1,
     'spot': 270,
     'on,': 616,
     'soooo': 25,
     'predictable.': 135,
     'well': 5855,
     'boring.': 307,
     'annoying.': 139,
     'meaningless.': 9,
     'offensive.': 21,
     'terrible.<br': 29,
     '/>an': 96,
     'example': 776,
     'how': 8456,
     'much': 8739,
     'stinks.': 31,
     'couples': 66,
     'set': 2027,
     'their': 11317,
     'big': 3083,
     'towards': 627,
     'nevada,': 3,
     'stopped': 204,
     '2': 1378,
     'police-officers,': 1,
     'stop': 880,
     'stop-sign.': 1,
     'guys': 947,
     'each': 2525,
     'finally': 1193,
     'bribe': 8,
     'officers': 77,
     'case': 984,
     'beer.': 10,
     'scene': 4060,
     'pointless': 351,
     'important': 779,
     '(or': 613,
     'relevant)': 1,
     'takes': 2131,
     '5': 632,
     'minutes!': 22,
     'just': 17309,
     'talk': 704,
     'talk,': 48,
     'without': 3145,
     'ever': 5077,
     'somewhere.<br': 6,
     '/>i': 3735,
     'puke': 19,
     'thinking': 955,
     'ending': 1600,
     'though.': 307,
     'apparently,': 114,
     'having': 2433,
     'problems': 613,
     'down': 2875,
     'father': 1315,
     'child.': 139,
     'many': 6388,
     'times': 2004,
     'happen': 680,
     'movies...': 13,
     'try': 1656,
     'something': 4387,
     'new!': 1,
     'cheated': 65,
     'ultimately': 427,
     'forgives': 17,
     'friend': 980,
     'affair': 245,
     'live': 1276,
     'happily': 125,
     'after.': 47,
     'yuck.<br': 4,
     '/>best': 40,
     'end,': 809,
     'couple': 1540,
     'shots': 704,
     'grand': 259,
     'canyon.': 11,
     'why': 4370,
     "couldn't": 1459,
     'keep': 1572,
     'camera': 1294,
     '90': 256,
     'minutes?<br': 1,
     '/>one': 394,
     'expect': 993,
     '(although': 223,
     'tries),': 1,
     'them.': 1253,
     'writers,': 51,
     'shame': 463,
     'you!<br': 12,
     '/>1/10.': 3,
     '"carriers"': 6,
     'follows': 448,
     'exploits': 55,
     'gals': 20,
     'stolen': 160,
     'mercedes': 12,
     'words': 564,
     'road': 297,
     'warrior': 74,
     'hood': 81,
     'hightailing': 1,
     'highway': 36,
     'beach': 114,
     'surfboards': 2,
     'strapped': 25,
     'top': 1261,
     'car.': 84,
     'brian': 291,
     '(chris': 25,
     'pine': 16,
     '"star': 78,
     'trek")': 1,
     'driving': 234,
     'bobby': 104,
     '(piper': 1,
     'perabo': 6,
     '"coyote': 4,
     'ugly")has': 1,
     'shotgun,': 7,
     'while': 4686,
     "brian's": 10,
     'younger': 434,
     'brother,': 159,
     'danny': 246,
     '(lou': 8,
     'taylor': 198,
     'pucci': 2,
     '"fanboys")': 1,
     'friend--not': 1,
     'exactly': 947,
     'girlfriend--kate': 1,
     '(emily': 13,
     'vancamp': 1,
     '"the': 2714,
     '2")': 2,
     'occupy': 16,
     'backseat.': 2,
     'quartet': 15,
     'twentysomething': 5,
     'characters': 5263,
     'living': 920,
     'nightmare.': 33,
     'viral': 3,
     'pandemic--which': 1,
     'co-directors': 2,
     '&': 3481,
     'co-scenarists': 1,
     'alex': 169,
     'pastor': 19,
     'david': 825,
     'tell': 1584,
     'us': 3199,
     'absolutely': 1452,
     'nothing': 3762,
     'about--has': 1,
     'devastated': 23,
     'america.': 108,
     'naturally,': 89,
     'lack': 1029,
     'exposition': 56,
     'shaves': 6,
     'least': 2741,
     'fifteen': 120,
     'minutes': 2079,
     'slowed': 15,
     'cynical': 130,
     'melodrama': 113,
     'humans': 205,
     'degenerate': 19,
     'crisis': 93,
     'become': 1488,
     'own': 2926,
     'worst': 2440,
     'enemies.<br': 4,
     '/>this': 2259,
     'lethal': 44,
     'virus': 86,
     'gives': 1562,
     'shingles': 1,
     'then': 6945,
     'bleed': 24,
     'die.': 80,
     'most': 8477,
     'everybody': 306,
     'runs': 472,
     'around': 3057,
     'wearing': 291,
     'white': 1102,
     'masks': 50,
     'nose': 91,
     'mouth': 206,
     'thin': 251,
     'rubber': 72,
     'band.': 34,
     'initially,': 23,
     'foursome': 2,
     'encounters': 113,
     'desperate': 282,
     'father,': 248,
     'frank': 377,
     '(christopher': 33,
     'meloni': 6,
     '"runaway': 4,
     'bride"),and': 1,
     'daughter': 684,
     'jodie': 42,
     '(kiernan': 1,
     'shipka': 1,
     '"land': 13,
     'lost")': 1,
     'blocking': 15,
     'suv.': 2,
     'swerves': 2,
     'tries': 1248,
     'waylay': 2,
     'them,': 629,
     'process,': 31,
     'oil': 125,
     'pan': 59,
     'ruptures': 1,
     'wind': 163,
     'foot.': 15,
     'reluctantly,': 6,
     'hitch': 17,
     'ride': 268,
     'seal': 24,
     'rear': 49,
     'wears': 156,
     'mask': 143,
     'speckled': 2,
     'blood.': 86,
     'heard': 1019,
     'doctors': 51,
     'curing': 7,
     'ailing': 21,
     'hospital': 232,
     'head': 1101,
     'it.': 5558,
     'sadly,': 187,
     'somebody': 255,
     'lied': 22,
     'frank.': 6,
     'physician': 10,
     'giving': 820,
     'last': 2699,
     'kids': 1343,
     'kool-aid': 3,
     'will': 8926,
     'put': 2275,
     'misery.': 16,
     'cure': 72,
     'improve': 79,
     'condition.': 24,
     'else': 1294,
     'town': 848,
     'dead.': 129,
     'kate': 211,
     'success': 387,
     'get': 8959,
     'dial': 21,
     'tone': 375,
     'every': 3885,
     'phone.': 18,
     'realizes': 190,
     'no': 11273,
     'hope': 1292,
     'lets': 303,
     'heroic': 98,
     'appropriate': 172,
     'suv': 13,
     'take': 3336,
     'off.<br': 67,
     '/>indeed,': 9,
     'qualifies': 41,
     'relentlessly': 51,
     'depressing': 171,
     'effects': 1475,
     'pandemic': 1,
     'four': 766,
     'sympathetic': 171,
     'into': 8990,
     'homicidal': 41,
     'murderers': 28,
     'protect': 154,
     'themselves.': 196,
     'reach': 228,
     'country': 580,
     'club': 239,
     'frolic': 11,
     'golf': 33,
     'course': 1273,
     'until': 1724,
     'show': 4623,
     'suits': 92,
     'pump-action': 1,
     'shotguns.': 1,
     'incredibly,': 14,
     'our': 2428,
     'protagonists': 102,
     'manage': 267,
     'escape': 401,
     'shot,': 177,
     'scare': 189,
     'falls': 810,
     'water': 323,
     'floating': 87,
     'corpse.': 16,
     'eventually,': 59,
     'discover': 255,
     'infected.': 2,
     'later,': 378,
     'gas,': 15,
     'blocks': 17,
     'like': 18779,
     'outset.': 7,
     'pair': 213,
     'older': 558,
     'christian': 306,
     'women': 1289,
     'lies': 249,
     'give': 3300,
     'birth': 145,
     'needs': 785,
     'help.': 108,
     'throws': 163,
     'caution': 17,
     'blasts': 16,
     'ladies': 196,
     'automatic': 34,
     'pistol': 18,
     'refuse': 59,
     'help': 1664,
     'catches': 103,
     'slug': 25,
     'leg': 67,
     'passenger,': 6,
     'kills': 489,
     'her.': 739,
     '<br': 5828,
     '/>no,"carriers"': 1,
     'beer': 86,
     'pizza': 31,
     'can': 10797,
     'either': 1182,
     'laugh': 905,
     'or': 16769,
     'because': 8736,
     'humor': 826,
     'virtually': 209,
     'non-existent.': 33,
     '84-minute': 1,
     'heroes': 203,
     'villains': 184,
     'care': 1174,
     'themselves': 778,
     'plight.': 14,
     'chris': 342,
     'makes': 4150,
     'impression': 350,
     'fun-loving': 11,
     'energetic': 41,
     'performance': 2133,
     'reason': 1776,
     'hang': 127,
     'hokum,': 5,
     'well-known': 77,
     'actress,': 162,
     'piper': 21,
     'perabo,': 1,
     'relegated': 22,
     'inconsequential': 18,
     'role.': 435,
     'bobby,': 10,
     'tragic': 293,
     'mistake': 254,
     'showing': 730,
     'compassion': 58,
     'dying': 247,
     'pays': 102,
     'awful': 944,
     'price.': 26,
     'testament': 67,
     "pine's": 1,
     'change': 774,
     'character': 5260,
     'point': 2312,
     'putting': 346,
     'before': 3430,
     'others.': 211,
     'essentially,': 14,
     'role': 2180,
     'him': 6385,
     'ability': 385,
     'pull': 332,
     'one-eighty': 1,
     'happy-go-lucky': 15,
     'guy': 2286,
     'heartless': 22,
     'guy.': 166,
     '/>the': 7409,
     'directors': 523,
     'spanish': 218,
     'brothers,': 81,
     'let': 1553,
     'momentum': 37,
     'flag.': 3,
     'since': 2651,
     'relief': 153,
     'sight,': 29,
     'sinks': 39,
     'predictability.': 9,
     '"irréversible"': 1,
     'cinematographer': 71,
     'benoît': 4,
     'debie': 2,
     'fantastic': 566,
     'job': 1632,
     'widescreen': 58,
     'lensing': 1,
     'unsavory': 16,
     'trip': 370,
     'becomes,': 4,
     'look': 3691,
     'dynamic': 99,
     'film.': 4490,
     'aside': 296,
     'closure': 22,
     'sense': 1690,
     'word,': 86,
     'suffers': 197,
     'horribly': 198,
     'cynical.': 7,
     'german': 449,
     'shepherd': 36,
     'attacks': 107,
     'conjures': 4,
     'suspense,': 130,
     'could': 7594,
     'been': 9074,
     'improved.': 8,
     'unfortunately,': 561,
     'brothers': 376,
     'tension': 378,
     'suspense.': 97,
     'fade-out,': 2,
     "don't": 7879,
     'what': 14055,
     'happens': 845,
     'anybody.': 12,
     'looking': 2110,
     'forward': 526,
     'seeing': 1876,
     'long': 2613,
     'time,': 1381,
     '"return': 31,
     'paradise,"': 1,
     'which': 10898,
     'gritty.': 7,
     'disappointed.': 280,
     'realistic': 506,
     'thing': 3514,
     'unpredictable': 61,
     'partly': 116,
     'paradise."': 1,
     '/>maybe': 87,
     'expecting': 561,
     'much.': 397,
     '/>on': 192,
     'positive': 465,
     'side': 889,
     'danes,': 12,
     'beckinsale': 35,
     'pullman': 21,
     'roles.': 215,
     'although': 2043,
     'didnt': 31,
     "danes's": 2,
     'couldnt': 6,
     'see': 10410,
     'anything': 2475,
     'done': 2347,
     'better,': 284,
     'emphasis': 92,
     'prison': 344,
     'conditions': 45,
     'sheer': 244,
     'horror.': 125,
     'cheery': 13,
     'realistic.': 101,
     'also': 8007,
     'action': 2403,
     'tension<br': 1,
     '"tragic"': 2,
     'ending.': 291,
     'predicted': 30,
     'time': 7945,
     'happened': 763,
     'them.<br': 241,
     '/>3/10': 40,
     'effect(s)': 1,
     'cause': 394,
     'generally': 427,
     'possible': 629,
     'real': 4026,
     'world': 2507,
     'hollywood': 1401,
     'remakes,': 9,
     'possible,': 75,
     'required.': 10,
     'haunting': 179,
     'given': 1726,
     'computer': 394,
     'treatment': 169,
     'courtesy': 42,
     '1st-class': 1,
     'cinematographer-turner-director': 1,
     'once': 1885,
     'showed': 475,
     'promise': 131,
     '(jan': 6,
     'de': 673,
     'bont-': 1,
     'speed)': 2,
     'produced': 396,
     'string': 108,
     'budget': 1070,
     'garbage': 229,
     '(twister,': 1,
     'speed': 165,
     '2).<br': 2,
     '/>actor': 4,
     'superfluous': 29,
     'type': 894,
     'seem': 2142,
     'realize': 639,
     'liam': 44,
     'neeson': 24,
     'cathrine': 2,
     'zeta-jones': 15,
     'act': 878,
     'wish': 894,
     'anywhere': 191,
     'lili': 21,
     'attempt': 985,
     'add': 703,
     'proceedings': 52,
     'whatever': 550,
     'might': 2851,
     'unknown': 228,
     'feels': 787,
     'half': 1550,
     'missing.': 56,
     'events': 710,
     'happen,': 110,
     'ghosts': 117,
     'rhyme': 31,
     'story': 8743,
     'ends': 813,
     'unsatisfying': 40,
     'non-event': 4,
     'meant': 593,
     'wrap': 69,
     'previous': 617,
     'inanity.<br': 2,
     '/>there': 830,
     'we': 9417,
     'screen': 1399,
     'now.': 292,
     'watch': 5709,
     'service': 139,
     'instead': 1571,
     'sake?': 1,
     'picture': 971,
     'intentions,': 29,
     'bacon': 48,
     'scientist': 247,
     'test': 190,
     'theory': 129,
     'invisibility,': 3,
     'shue': 15,
     'usual': 753,
     'apart': 433,
     'that,': 1286,
     'your': 5600,
     'typical': 739,
     'thriller': 457,
     'filmed': 618,
     'soundstage': 7,
     'special': 1812,
     'galore,': 11,
     'minus': 55,
     'kind': 2545,
     'humour,': 61,
     'wit': 164,
     'soul.': 65,
     'words,': 168,
     'waste': 1377,
     'watching': 4117,
     'this.': 1149,
     'audiocassette': 1,
     'tape': 157,
     'delancie': 1,
     'invisible': 149,
     'man': 3872,
     'instead,': 305,
     'starring': 439,
     'leonard': 77,
     'nimoy.': 1,
     'now': 3006,
     'good,': 988,
     'hg': 8,
     'wells': 77,
     'served,': 5,
     'unlike': 505,
     'mess.': 166,
     'chose': 192,
     'got': 3503,
     'score': 711,
     'here': 3055,
     'imdb.': 54,
     'lot': 3611,
     'poor': 1543,
     'taste': 279,
     "someone's": 95,
     'fixing': 18,
     'score.<br': 14,
     '/>either': 10,
     'disappointment.': 128,
     'stupid': 1139,
     'far': 2582,
     'fetched': 20,
     'title': 1066,
     'suggest.': 8,
     'summary': 103,
     'plot': 4776,
     '-': 9355,
     'goes:': 6,
     'felt': 1479,
     'someone': 2083,
     'thinking:': 9,
     '"wouldn\'t': 2,
     'cool': 632,
     'where': 6056,
     'snakes': 46,
     'plane?': 4,
     'go': 4552,
     'crazy': 454,
     'start': 1420,
     'biting': 42,
     'stuff?!?"': 1,
     'it!': 500,
     'unoriginal.': 8,
     'cgi': 253,
     '(but': 223,
     'cut': 782,
     'corners': 21,
     'mind': 1239,
     'recommend': 1603,
     'anyone!).': 1,
     'acting': 4747,
     'poor,': 133,
     'unbelievable': 253,
     'stereo': 15,
     'types.<br': 3,
     '/>to': 258,
     'sum': 141,
     'up:': 33,
     'stay': 704,
     'away!': 26,
     'seen.': 750,
     'deceives': 4,
     'audience': 1499,
     'maybe': 1990,
     'hope.': 39,
     'line': 1240,
     'laughable': 217,
     'best,': 272,
     'cringe.': 13,
     "'zombie": 11,
     "nation'": 2,
     'implies': 29,
     'hoard': 2,
     'zombies': 311,
     ...}



### Vocabulary list
```python
# Build a vocabulary as list
vocab_list = GetVocabulary(train_set['Reviews'])
dict_vocab = {}
for i in range(len(vocab_list)):
    dict_vocab[vocab_list[i]] = i

```


```python
dict_vocab
```




    {'self-evaluation.<br': 0,
     'three-episode,': 1,
     'Germany!),': 2,
     'Jack!': 3,
     'wins': 4,
     'large;': 5,
     "Selden's": 6,
     'brat.': 7,
     '"eat': 8,
     'necessarily."': 9,
     'Lyndon"': 10,
     'older)': 11,
     'Bandit': 12,
     'gauntlet': 13,
     '*POSSIBLE': 14,
     'holes...how': 15,
     "`Superhero'": 16,
     'rippings': 17,
     'downsizing,': 18,
     'invincible,': 19,
     'cancer",': 20,
     'wreckage,': 21,
     'series,even': 22,
     'twin=doppelganger,': 23,
     "Borden's": 24,
     'question..not': 25,
     'platitude': 26,
     'thumbing': 27,
     'commoners': 28,
     'relaxes': 29,
     "sinise's": 30,
     'Ben:': 31,
     '/>India,': 32,
     'fulfilled,': 33,
     'vacuum.<br': 34,
     'agent."': 35,
     '"Friends".<br': 36,
     'man\x97if': 37,
     'Kristopherson,': 38,
     'Wust': 39,
     'France?"........<br': 40,
     'misdemeanor': 41,
     'backdrop?': 42,
     'chains': 43,
     'Janine': 44,
     'surroundings)': 45,
     '1949er.': 46,
     'Express."': 47,
     "Scream'": 48,
     'dought': 49,
     'licking': 50,
     'patient.<br': 51,
     'disappearance"': 52,
     'higherpraise.com,': 53,
     'twenty-nine': 54,
     'brontosaurus;': 55,
     "'suble": 56,
     'emergence': 57,
     "'Hanzo'": 58,
     'indiscretionary': 59,
     'Assante': 60,
     'fundamental,': 61,
     'Jump,': 62,
     'Brutal': 63,
     'better,however,': 64,
     'veiw.': 65,
     'Torched': 66,
     'Talinn': 67,
     'terrorist-group': 68,
     'Nudity/Sexuality:': 69,
     'cast...Kevin': 70,
     'pg': 71,
     'Pierce': 72,
     '/>SFX': 73,
     'snippets)': 74,
     '(sample': 75,
     'show.There': 76,
     'car".': 77,
     'CHARACTERS!<br': 78,
     'e-mailed': 79,
     'Whilhelm': 80,
     'beaut!).<br': 81,
     'welding': 82,
     '(Joking': 83,
     'cold-bloodedness.': 84,
     'small.': 85,
     'world".Johnson(Cheadle),a': 86,
     'depression.': 87,
     'tamped': 88,
     'type.': 89,
     'orbit': 90,
     'correct)': 91,
     '1999),': 92,
     'Vic,': 93,
     'perishes': 94,
     '"modernization"': 95,
     'limp?': 96,
     'Pagels.': 97,
     'denomination)': 98,
     '"free"': 99,
     '8FTDF': 100,
     '"pull': 101,
     'stockings.': 102,
     'Homophobia': 103,
     'favors.': 104,
     'once-off': 105,
     "'innocent,": 106,
     'horrors"': 107,
     'Weighill': 108,
     'Stunt': 109,
     'swear': 110,
     '1-in-1000': 111,
     'amusing!<br': 112,
     'pseudo': 113,
     'epos': 114,
     'grimness.': 115,
     '5-star': 116,
     '"port"': 117,
     'euro': 118,
     'well-paced,': 119,
     '-.': 120,
     'Grave")': 121,
     "games'.": 122,
     '"Muriel\'s': 123,
     'wat': 124,
     'Orang': 125,
     'publicity-seeking': 126,
     'together--Disney-style': 127,
     'and': 128,
     'amateur-productions.': 129,
     'unforgivably': 130,
     'Blazer': 131,
     'Companeros",': 132,
     'book,': 133,
     '`real': 134,
     'deafening,': 135,
     'archives!<br': 136,
     'made,,,,': 137,
     'apocalypse.': 138,
     'yech,': 139,
     '"Ohmagod\'s!"': 140,
     'Cringe-inducing': 141,
     'mind-catching': 142,
     'told!I': 143,
     'die;': 144,
     '~80': 145,
     "Reidelsheimer's": 146,
     'Endor.': 147,
     'slack-jawed': 148,
     'misogynistic.Especially': 149,
     'make-your-own-pizza': 150,
     'eyeshadow': 151,
     'noses"': 152,
     '"SAS"': 153,
     'raved': 154,
     '"Detour")': 155,
     'yetis': 156,
     'chalkboard,': 157,
     'take,': 158,
     'Stanton,': 159,
     'F.O."': 160,
     'Hoffer),': 161,
     'enquiry.': 162,
     '"Coming': 163,
     '$750,000': 164,
     'F-Bomb': 165,
     'life-endangering': 166,
     'Mexican': 167,
     'Glenaan': 168,
     "Cassavetes'": 169,
     'Rifleman")': 170,
     'initially!)': 171,
     'projector.': 172,
     'reading)that': 173,
     'Deerhunter': 174,
     'demurs': 175,
     'coin;': 176,
     'twister.': 177,
     'church.': 178,
     'believability-': 179,
     'even!!!!!!!!!': 180,
     "'goal'": 181,
     'Silvermen)': 182,
     '"Bibbidi-Bobbidi-Boo,"': 183,
     'PATRIOT.': 184,
     '"hero,"': 185,
     '/>Morris': 186,
     'Winch': 187,
     'smother': 188,
     'Baby",': 189,
     'trail....good': 190,
     'Bettina': 191,
     'Decide': 192,
     'Mosters': 193,
     'Welch?!': 194,
     'Characters.': 195,
     'sommeil."<br': 196,
     'roue"': 197,
     'mid-thirties.': 198,
     'chills.<br': 199,
     'contemperaneous': 200,
     'family!),': 201,
     'WHORE': 202,
     'flicks"': 203,
     'however...is': 204,
     '"Braveheart"<br': 205,
     'poem...a': 206,
     'beginning?': 207,
     'slick.': 208,
     'Filone': 209,
     'thrilling.': 210,
     'ohhhhh': 211,
     'Eltinge,': 212,
     'fetching.': 213,
     'Selten': 214,
     'miseries.': 215,
     'Meriwether': 216,
     'Preity.<br': 217,
     'crown': 218,
     "Pereira's": 219,
     'Hobbit': 220,
     'soap.<br': 221,
     'fixed.': 222,
     'mother;': 223,
     'Marcella,': 224,
     'Dreams': 225,
     'Tung': 226,
     'sunbathing,': 227,
     'Tenberken': 228,
     "verel's": 229,
     'reason.<br': 230,
     'Fish"': 231,
     'stylistics': 232,
     'choices,a': 233,
     'commission.': 234,
     'workplace.': 235,
     'Kill,",\'80,': 236,
     "Metzger's": 237,
     'windows)': 238,
     '(fat': 239,
     "Debra's": 240,
     'Nobody,': 241,
     '"MST3K";': 242,
     'Gentility': 243,
     'DVD...': 244,
     "'Unsolved": 245,
     'fluent.': 246,
     'wow...this': 247,
     'nothing:some': 248,
     'competitiveness': 249,
     'Fletcher,': 250,
     'goosebumps': 251,
     'think....no!<br': 252,
     '"Blonde': 253,
     'that???<br': 254,
     'Guiness,': 255,
     'film!)': 256,
     'backyard.<br': 257,
     'MACBETH...!<br': 258,
     'talented...': 259,
     'much\x97Chandu': 260,
     'Maddin,': 261,
     '/>BEDKNOBS': 262,
     'light-skinned,': 263,
     'buffs.<br': 264,
     'COVER': 265,
     '/>Explanations': 266,
     'cackles': 267,
     "'tape-slide'": 268,
     'kleine': 269,
     ',Busta': 270,
     'Burgi/Alien-': 271,
     'Hisaishi': 272,
     "'Where": 273,
     '"L\'': 274,
     'pub.<br': 275,
     "'stars',": 276,
     'female,': 277,
     'university,': 278,
     'interlocking': 279,
     'bar,': 280,
     'woad': 281,
     'wealthier': 282,
     'Runner-esque': 283,
     'union,': 284,
     'So-Yi': 285,
     'Grace).': 286,
     'Bresslaw),': 287,
     '/>http://blog.myspace.com/locoformovies': 288,
     'Hackman': 289,
     '"claims"': 290,
     'hipness': 291,
     'whistleblower': 292,
     'meandered,': 293,
     'Cappomaggi': 294,
     'FELLINI': 295,
     '"falling"': 296,
     'pitiful': 297,
     'comprehendable': 298,
     "Union's": 299,
     'illuminations,': 300,
     'elf,': 301,
     'obscene.': 302,
     "Wrecks'": 303,
     'place,"': 304,
     'Netherlands,': 305,
     'Headmaster': 306,
     'END!': 307,
     'playmates,': 308,
     'Wallace-Stone': 309,
     'happy.Gabriel,on': 310,
     "Drexler's": 311,
     '<i>Boomerang</i>.': 312,
     '"teleplay"': 313,
     'DVDs,': 314,
     'present:': 315,
     'Writer/': 316,
     'Garwin': 317,
     '(fans': 318,
     "(Currie's": 319,
     'ed': 320,
     'uncut,': 321,
     'Imagine,': 322,
     'noticed-damn': 323,
     'bogged': 324,
     'perpetrator,': 325,
     'UNINTERESTING.': 326,
     'posers,': 327,
     "years'70.": 328,
     '/>Tony': 329,
     'body-stimulating': 330,
     'Snuka': 331,
     'BTW': 332,
     'trip;': 333,
     'Rajpal': 334,
     'laughing!)': 335,
     'family...The': 336,
     'marketed,': 337,
     'language....': 338,
     'Bambi': 339,
     '/>Editor<br': 340,
     'handicapped".': 341,
     'fast-forwarded,': 342,
     'employed': 343,
     'patterned': 344,
     'else?': 345,
     'spouse,creepy': 346,
     'scenes.The': 347,
     'WKRP': 348,
     '"Calendar': 349,
     'knew': 350,
     'cardiovascular': 351,
     '/>Maka': 352,
     'Irwin).': 353,
     'dictator.': 354,
     'auspices,': 355,
     'camus': 356,
     "solved'": 357,
     '"Autofocus"': 358,
     'rapist-killer': 359,
     'opportunist': 360,
     'Dispensationalists.': 361,
     'statements.<br': 362,
     'quickies.': 363,
     '"man': 364,
     'body!)': 365,
     'Sheppard)': 366,
     'attitude!': 367,
     'room-mates': 368,
     'Weekend".': 369,
     '/>Government': 370,
     "whodunit,it's": 371,
     'C.B.': 372,
     'Smiths?': 373,
     'machina.<br': 374,
     'Ullswater)': 375,
     'komodo*coughs.': 376,
     'gruesom': 377,
     'entertainment,': 378,
     'striking,': 379,
     '/>Credits': 380,
     "'Iron": 381,
     'rocking': 382,
     'gambling.': 383,
     '3<br': 384,
     'Britain",': 385,
     'riot-sequence': 386,
     'silly!': 387,
     '(thankfully),': 388,
     'GO.': 389,
     '2.35:1': 390,
     'discern.': 391,
     'Pride?)': 392,
     'Sentry,': 393,
     'Odysseus:': 394,
     'Peel"': 395,
     "Chomsky's": 396,
     '(4/17/45)': 397,
     'wideboy': 398,
     'volumes.<br': 399,
     "Matrix'.<br": 400,
     'grandfathers.': 401,
     'Chaykin': 402,
     'murdered-child': 403,
     '/>*Note': 404,
     'direction!<br': 405,
     "'Aussie'": 406,
     'rehabilitation': 407,
     'Leninist': 408,
     'Lost,"': 409,
     'Juarez': 410,
     'heterosexuals).': 411,
     'smoke-shrouded': 412,
     'PERDITION': 413,
     'inanimate': 414,
     'Teenaged': 415,
     "Ladd's,": 416,
     'fallen.': 417,
     'stab.': 418,
     'Baldry': 419,
     'Jess,': 420,
     'terrific.everyone': 421,
     'shock.<br': 422,
     'relationship--and': 423,
     '/>Religion,': 424,
     '"Pandora\'s': 425,
     'math?': 426,
     'Takashi': 427,
     'neo-noir': 428,
     'Rock",': 429,
     'innit?': 430,
     'STD.': 431,
     'baskets': 432,
     'lemons).': 433,
     'sweethearts"': 434,
     'DOORS': 435,
     'business.MaChesney': 436,
     'matters.': 437,
     'abodes.': 438,
     'iceberg)': 439,
     'presence),': 440,
     'Christa': 441,
     'Trumps': 442,
     'McNALLY': 443,
     'Tomorrow:': 444,
     'to/directly': 445,
     "Carltio's": 446,
     'Queda..especially': 447,
     'artless': 448,
     'Meatballs': 449,
     'off,i': 450,
     'impulsiveness,': 451,
     "/>'Loulou's": 452,
     'met).': 453,
     'over".': 454,
     'FRAT': 455,
     'Perú': 456,
     'hype.': 457,
     'swears.': 458,
     'Devastating,': 459,
     'Animaniacs': 460,
     'Neo-Realist': 461,
     '/>Another': 462,
     "Basinger's": 463,
     'Faridany': 464,
     'order".': 465,
     'guide,': 466,
     'overplayed-on-Cartoon-Network': 467,
     'slaves.': 468,
     'scholars,': 469,
     'hideout.': 470,
     '"Angel\'s': 471,
     'woman"': 472,
     'clubbed': 473,
     'republicanism.<br': 474,
     'correctional': 475,
     "taste'": 476,
     "3's": 477,
     'fates.<br': 478,
     'Captain!!!': 479,
     '/>Li': 480,
     'performance:In': 481,
     'Bulgaria': 482,
     'dancing.': 483,
     'Fiction,': 484,
     'Seater,': 485,
     "Barjatya's": 486,
     'music--one': 487,
     'rueful': 488,
     'Meandering': 489,
     'shows,Sgt.Cutter': 490,
     'MPAA': 491,
     'skinned': 492,
     'pun)': 493,
     "Vallette's": 494,
     'Siamese': 495,
     'wildcat': 496,
     "apt's/tenements": 497,
     'honestly,': 498,
     '/>Glenda': 499,
     'dread.': 500,
     'pop/rock': 501,
     'naïve.': 502,
     'Johnathon': 503,
     'reappraised': 504,
     'lowlight': 505,
     "('Come": 506,
     'South-East': 507,
     'Hytner,': 508,
     'unsympathetic': 509,
     'Opposites': 510,
     'promise:': 511,
     'Estefan': 512,
     'Peaks,': 513,
     'twisting,': 514,
     'health': 515,
     'horribble,,': 516,
     "Killer'": 517,
     '"rational"': 518,
     '/>DETENTION': 519,
     'fellowship,': 520,
     'Demonio"': 521,
     'angasm...': 522,
     '4-ever"': 523,
     'action:': 524,
     "'preemptively'": 525,
     'restaurant/donut': 526,
     'over-truncated': 527,
     'japanese': 528,
     'Possible)': 529,
     'neous",': 530,
     'POSTAl.': 531,
     'Food,"': 532,
     'Scooby-Doo...': 533,
     'Granger;': 534,
     'Christover': 535,
     'associations': 536,
     'Murdock),': 537,
     'end).': 538,
     '/>Speaking': 539,
     'Jay,': 540,
     'Charisma': 541,
     '*genuinely*': 542,
     'Czerny': 543,
     'Learn': 544,
     'site!"': 545,
     'nightmares.<br': 546,
     '(unbeknownst': 547,
     'Bat-Man': 548,
     'life,"': 549,
     '1922.<br': 550,
     'cinematography--': 551,
     'buildings.': 552,
     'civics': 553,
     'dithered,': 554,
     'through.They': 555,
     'MONEY.': 556,
     'examp': 557,
     '"Joy': 558,
     "'Hoovervilles'": 559,
     'imagination.': 560,
     "Yasmin's": 561,
     'early-century': 562,
     'If?"<br': 563,
     '"access"': 564,
     'Bass.': 565,
     'Voiced': 566,
     'stemmed': 567,
     'career-but': 568,
     '(allegedly': 569,
     "/>Gene's": 570,
     'short.': 571,
     'crime/yakuza': 572,
     'Louvers)': 573,
     '"forensic': 574,
     'cheapies': 575,
     'wannabe.<br': 576,
     'Showtime.': 577,
     'pseudo-lesbian': 578,
     'Shekhar': 579,
     'Deniro.': 580,
     'feedback,': 581,
     'riot!': 582,
     'Eleven,': 583,
     'sleep!': 584,
     'swooping': 585,
     'retinas': 586,
     "rejected.There's": 587,
     'Down’s': 588,
     'refused': 589,
     'heads....what': 590,
     'whiskers': 591,
     'touch/feel': 592,
     'Werecat': 593,
     "'prepared'": 594,
     '--as': 595,
     'drivel!<br': 596,
     '/>Frank': 597,
     "leaders'": 598,
     'peeing,': 599,
     'Molly?)': 600,
     'blah<br': 601,
     'pleasant': 602,
     '"CLOSET",': 603,
     'collide!"': 604,
     'GORGEOUS!,': 605,
     '(Young': 606,
     'dehumanization': 607,
     'half-truth': 608,
     'of?,': 609,
     'salesman,': 610,
     'Tierney,': 611,
     'grandmothers.': 612,
     "director's?": 613,
     'Mulroney)': 614,
     'insurgents;': 615,
     'Haired': 616,
     'successfully),': 617,
     'fight...': 618,
     '/>ANYWAY,': 619,
     'mercenary': 620,
     'Brooklyn.Shy': 621,
     'spooky/scary': 622,
     'Dex,"': 623,
     '2.7': 624,
     'Bracy': 625,
     'Eburne': 626,
     'Instinct",': 627,
     'emotion."': 628,
     'Montano.': 629,
     'grounds!").': 630,
     '/>"Stardust"': 631,
     'collaborator)': 632,
     'enlightening,': 633,
     'SOUL': 634,
     'harassment,': 635,
     'weed.': 636,
     'Golino)': 637,
     'F.L.': 638,
     'Bunch.<br': 639,
     'pilot': 640,
     "Atkins'": 641,
     "'wise'": 642,
     'Vivica': 643,
     'aka': 644,
     'Charlie;': 645,
     'SOON': 646,
     'Monroe).': 647,
     'ensue...': 648,
     'Robbins?': 649,
     'rubbish.<br': 650,
     'Silva,': 651,
     'complacency': 652,
     'doubt)': 653,
     'afford.': 654,
     'offended...': 655,
     'why.': 656,
     'forget.<br': 657,
     'whinging': 658,
     'Mervyn': 659,
     'pertfectly': 660,
     'later...': 661,
     "IPOYG',": 662,
     'buck--provided,': 663,
     'obvious),': 664,
     "Tara's": 665,
     '"meeting"': 666,
     'Mecca,': 667,
     'horse-s**t.<br': 668,
     'characters.William': 669,
     'daddy-o.': 670,
     'Digisoft-rats': 671,
     'violence/gore"<br': 672,
     'Goddesses': 673,
     'loosing': 674,
     'noticed...': 675,
     'OXFORD,': 676,
     '/>*Spoiler*': 677,
     'Forysthe,': 678,
     'ensembles.': 679,
     'Tatta,': 680,
     "'there'.": 681,
     'beside': 682,
     'fare': 683,
     '"Der': 684,
     'MAN"...that\'s': 685,
     "'state-of-being.'": 686,
     'looked.<br': 687,
     'MAKES': 688,
     'Austin.': 689,
     'horse.<br': 690,
     "Arabia',and": 691,
     'gravelings': 692,
     'PASTY': 693,
     'dry': 694,
     'it!?!': 695,
     'soul-crushing,': 696,
     'Something,"': 697,
     'Teddi': 698,
     'Then....<br': 699,
     'Russ,': 700,
     "Defence,'": 701,
     'Hanahan': 702,
     "(GPS's)": 703,
     'Sgt.Beckett': 704,
     'answered;': 705,
     'Carbone': 706,
     'restored': 707,
     'state-of-the-art': 708,
     'excessively': 709,
     'genie;': 710,
     'oppress': 711,
     'Sleeper': 712,
     'e-waste': 713,
     'died"?': 714,
     'TESTICLE': 715,
     'veil': 716,
     'hybrid\x97not': 717,
     'trowel': 718,
     'flea.': 719,
     'Strausmann': 720,
     'makeup-': 721,
     'medically.': 722,
     'Hedy': 723,
     'trumpets?': 724,
     "ALICE'S": 725,
     'Directed': 726,
     '"Elie"': 727,
     'Kaajal.Ravi': 728,
     'rifles!!': 729,
     'gooey.': 730,
     'Game":': 731,
     'locales(i.e.': 732,
     'instance:': 733,
     'Seagals': 734,
     '"Boricuas"': 735,
     'entirety': 736,
     'endearingly)': 737,
     'cd.': 738,
     '(Spielberg).': 739,
     'roomy,': 740,
     'culture': 741,
     'OGRE': 742,
     'low-angle': 743,
     'fun,': 744,
     'Mario...remember?': 745,
     'Pileggi,': 746,
     'rutting': 747,
     'Saldy': 748,
     'professions,': 749,
     'sex-slave': 750,
     'reason-': 751,
     "'re-enactment',": 752,
     'horoscope': 753,
     'pre-Beatlemania': 754,
     'crews)': 755,
     'consumed.<br': 756,
     'mind"': 757,
     '/>I´m': 758,
     'wails': 759,
     'Please!)': 760,
     'Explain.': 761,
     "Anthony's": 762,
     'ammo)': 763,
     'Yojiro': 764,
     'SENSUOUS': 765,
     "'Ice": 766,
     'styles.': 767,
     'stone-Buddha': 768,
     'something),': 769,
     'insufficient,': 770,
     'funding...<br': 771,
     'uninvolved,': 772,
     'well,that': 773,
     'Shetland': 774,
     'foolish.': 775,
     'shock-rocker': 776,
     '/>Frankly': 777,
     'Bates,': 778,
     'Well...it': 779,
     '_real_': 780,
     'sub-average,': 781,
     "end'.": 782,
     'eighth': 783,
     'honour-killing': 784,
     "world'": 785,
     'motion)': 786,
     'Comics",': 787,
     'gaudy.': 788,
     'Hypercube,': 789,
     'McElhone': 790,
     'constipation.': 791,
     'dreamgirl,': 792,
     'Benjamin': 793,
     'Storytelling,': 794,
     'BooBoo,': 795,
     'bewilderment,': 796,
     'mummy.': 797,
     'midlands.': 798,
     'grinded': 799,
     'stillness': 800,
     'paved': 801,
     'windows;': 802,
     'scrutinized,': 803,
     'her!!': 804,
     'demonise': 805,
     'wall!': 806,
     'McElhone???)': 807,
     'Corpses.': 808,
     'friendship,': 809,
     'cheerleader': 810,
     'disfigured.': 811,
     'introduce,': 812,
     '8.5/10!': 813,
     '**SPOILERS**': 814,
     'pet.': 815,
     'ignorantly': 816,
     'lift.<br': 817,
     "Whately's": 818,
     'basics.': 819,
     "'After": 820,
     'Talking"': 821,
     'Gwyenths': 822,
     'cars)': 823,
     '/>Operator': 824,
     'Patel.': 825,
     'ARCHENEMY': 826,
     'anatomy,': 827,
     'get?<br': 828,
     'oceans,': 829,
     'k-911,': 830,
     'atone': 831,
     'Xica.': 832,
     'swooningly': 833,
     '/>BTW:': 834,
     '("Detour")': 835,
     '"Venantino': 836,
     'Lin).<br': 837,
     'Lee!': 838,
     '"horror': 839,
     'diner': 840,
     'romantic-comedy,': 841,
     'Guardian"': 842,
     'Posey,': 843,
     "Adamson's": 844,
     'crossbow': 845,
     'neotenous': 846,
     'Days:': 847,
     'Squirrel,': 848,
     'LeCarré': 849,
     'Suicune': 850,
     'suspects:': 851,
     'chemically': 852,
     'sober': 853,
     '"quartiers"': 854,
     'bang.<br': 855,
     'reeks,': 856,
     'villain': 857,
     '/>ejames6342': 858,
     'prospectors,': 859,
     'set-ups,': 860,
     'Demonico"': 861,
     'Belushi]': 862,
     'aargh': 863,
     'WAS!!!The': 864,
     'Carface.': 865,
     '(NIGHT': 866,
     '"Super': 867,
     'tea/go': 868,
     'acting...).<br': 869,
     "Dick's": 870,
     'Safran': 871,
     '/>4/10': 872,
     'Berridi': 873,
     "'too": 874,
     "ANTS'": 875,
     '/>Turiqistan': 876,
     '/>Aiding': 877,
     'blood-thirsty': 878,
     'cancels': 879,
     'Whpat': 880,
     'sirs': 881,
     'Point.<br': 882,
     "(/Woman/Dog)'": 883,
     'semi-sympathetic': 884,
     'themes,but': 885,
     'Bites': 886,
     'Dzundza': 887,
     'Minuses:': 888,
     'inhabitants': 889,
     'starpower,': 890,
     '($100': 891,
     "Dingman's": 892,
     'partnership': 893,
     "{I'm": 894,
     'artists,': 895,
     "'cowardice'.": 896,
     'trooper.': 897,
     'Owl??<br': 898,
     'Spooky.': 899,
     'difficult,': 900,
     '"...we': 901,
     'sharp)': 902,
     'bailout': 903,
     'evils.': 904,
     'Warriors",': 905,
     'ANYTHING.<br': 906,
     'Gabe."': 907,
     'standards,': 908,
     'maggots.<br': 909,
     'guy"),': 910,
     'Sherbert,': 911,
     'Cameron!': 912,
     'centerfold': 913,
     'Trans': 914,
     'Tutsi': 915,
     'mutiracial': 916,
     "Gandhiji's": 917,
     'reddish/white': 918,
     'Sharifah': 919,
     '*DAD*!"': 920,
     'jiggle': 921,
     "GENTLEMAN'S": 922,
     'margaritas.<br': 923,
     '/>Lawyer:': 924,
     'quake?)': 925,
     'anymore:': 926,
     'Kate': 927,
     'tins': 928,
     'latter)': 929,
     '"bang."': 930,
     'Albeniz': 931,
     'toughness': 932,
     'expected."': 933,
     'do.I': 934,
     'soundtrack;': 935,
     'Jirí': 936,
     'presume,': 937,
     'Shame".': 938,
     'see,"Mayerling"is': 939,
     'illnesses:': 940,
     'Messrs.': 941,
     'image".<br': 942,
     'deconstruction': 943,
     'movie",': 944,
     '/>*****SPOILERS': 945,
     'Lunes': 946,
     '1.The': 947,
     'Brown).': 948,
     'arrivals,': 949,
     'curling': 950,
     "Me'": 951,
     'RAW!': 952,
     "powerful,it's": 953,
     'anticipated.': 954,
     '"phoebus"..': 955,
     'savoir-faire': 956,
     'innocent': 957,
     'B&W': 958,
     "'dancer',": 959,
     'States"': 960,
     'denominator.': 961,
     '/>Wallace': 962,
     'R.S.': 963,
     'valueless': 964,
     'verrrrry': 965,
     'cartoonishly': 966,
     'afroamerican': 967,
     'plus,': 968,
     'Stillborn.': 969,
     'land:': 970,
     'museum,': 971,
     'Heldar,': 972,
     'needy': 973,
     'Bondless': 974,
     'energy";': 975,
     'cinema--very': 976,
     'newspaper;': 977,
     'Hardwicke,': 978,
     'Itami': 979,
     'maid/companion.<br': 980,
     '/>Paralelling': 981,
     'hideous;': 982,
     'Understandably': 983,
     'contest"': 984,
     'unendearing.': 985,
     'Treasure': 986,
     'stroked': 987,
     'Jury<br': 988,
     'me...an': 989,
     'H': 990,
     '"training"': 991,
     'me?<br': 992,
     'Chomsky.': 993,
     'Slater.': 994,
     'idiotic:': 995,
     'p.s.': 996,
     'thing--longtime': 997,
     'good.Laughed': 998,
     'cursorily.': 999,
     ...}




```python
count_the = 0
count_the_pos = 0
#Probability of the occurrence
for index, row in train_set.iterrows():  
    label = row['Label']
    data = row['Reviews']
    data = data.lower().split()
    if('the' in data):
        count_the += 1
# print(count_the)
p_the = count_the / len(train_set)
print('P[the] = ' + str(p_the))

#Conditional probability based on the sentiment
for index, row in train_set[12500:25000].iterrows():   
    label = row['Label']
    data = row['Reviews']
    data = data.lower().split()
    if('the' in data):
        count_the_pos += 1

p_the_pos = count_the_pos / len(train_pos)
print('P[“the” | Positive]  = ' + str(p_the_pos))
```
### Calculate the probability

    P[the] = 0.99084
    P[“the” | Positive]  = 0.98952


### Five-fold cross validation
```python
# five fold cross validation

correct = 0
k = 5
k_fold=[]
train_set = train_set.sample(frac=1)
index=set(range(train_set.shape[0]))
for i in range(k):
    if i==k-1:
        k_fold.append(list(index))
    else:
        tmp=random.sample(list(index),int(1.0/k*train_set.shape[0]))
        k_fold.append(tmp)
        index-=set(tmp)

for i in range(k):
    tra=[]
    dev=k_fold[i]
    for j in range(k):
        if i!=j:
            tra+=k_fold[j]
    train = train_set.iloc[tra]
    test = train_set.iloc[dev]
    neg, pos, neg_num, pos_num, neg_word_num, pos_word_num = getWords(train)
    for idx, data in test.iterrows():
        review = data['Reviews']
        label = data['Label']
        result = Predict(neg, pos, neg_num, pos_num, neg_word_num, pos_word_num, str(review))

        if int(result) == label:
            correct += 1;
    print(correct/len(test))
    correct = 0
 
```

    0.5178
    0.5412
    0.5476
    0.516
    0.514


### Using the test dataset
```python
# Using the test dataset
correct = 0
neg, pos, neg_num, pos_num, neg_word_num, pos_word_num = getWords(test_set)
for idx, data in test_set.iterrows():
    review = data['Reviews']
    label = data['Label']
    result = Predict(neg, pos, neg_num, pos_num, neg_word_num, pos_word_num, str(review))
    if int(result) == label:
            correct += 1;
print(correct/len(test_set))

```

    0.52928

